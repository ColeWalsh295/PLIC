mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = relevel(as.factor(Lab_Purpose), ref = 'Reinforce physics concepts'))
df.Centered <- Create.Class.Variables(df.matched)
df.Centered$GenW <- df.Centered$Gender == 'Women'
df.Centered$GenNon <- df.Centered$Gender == 'Non-binary'
df.Centered$URM_StatusURM <- df.Centered$URM_Status == 'URM'
df.Centered$MajorEng <- df.Centered$Major == 'Engineering'
df.Centered$MajorPhys <- df.Centered$Major == 'Physics'
df.Centered$PurposeSkills <- df.Centered$Lab_Purpose == 'Develop lab skills'
df.Centered$PurposeBoth <- df.Centered$Lab_Purpose == 'Both about equally'
df.Centered$LevelCalc <- df.Centered$Lab_Level == 'Intro-Calculus'
mod.null <- lmer(Gain ~ (1 | School/Class_ID), df.Centered)
summary(mod.null)
r.squaredGLMM(mod.null)
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | Class_ID), df.Centered)
summary(mod.main)
r.squaredGLMM(mod.main)
mod.interaction <- lmer(Gain ~ PreScores + (Gender + URM_Status) * Lab_Purpose + Major + Lab_Level + (1 | Class_ID), df.Centered)
summary(mod.interaction)
r.squaredGLMM(mod.interaction)
library(reghelper)
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
beta(mod.interaction, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
reghelper::beta(mod.interaction, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
reghelper::beta(mod.interaction)
beta(mod.interaction)
mod.interaction <- lmer(Gain ~ PreScores + (Gender + URM_Status) * Lab_Purpose + Major + Lab_Level + (1 | Class_ID), df.Centered)
beta(mod.interaction, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | Class_ID), df.Centered)
beta(mod.interaction, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
class(mod.null) <- "lmerMod"
class(mod.interaction) <- "lmerMod"
plot(mod.interaction, xlab = 'Fitted values', ylab = 'Residuals')
plot(mod.interaction, xlab = 'Fitted values', ylab = 'Residuals')
qqmath(mod.interaction)
beta(mod.interaction, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
class(mod.null) <- "lmerMod"
class(mod.main) <- "lmerMod"
class(mod.interaction) <- "lmerMod"
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
mod.main <- lmer(Gain ~ PostScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | Class_ID), df.Centered)
class(mod.main) <- "lmerMod"
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
mod.main <- lmer(PostScores ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | Class_ID), df.Centered)
class(mod.main) <- "lmerMod"
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | Class_ID), df.Centered)
class(mod.main) <- "lmerMod"
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
set_theme(base = theme_classic(base_size = 12))
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | Class_ID/School), df.Centered)
class(mod.main) <- "lmerMod"
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | School/Class_ID), df.Centered)
class(mod.main) <- "lmerMod"
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p2 <- p1
p2$data$group <- factor(p2$data$group, levels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
p2
p1$data$x
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$x <- c(3, 2, 1)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$x
p2$data$x
p2
p2$data$group
p2$data$x
p2
p2$data$x <- c(1, 2, 3)
p2
p2$labels$x
p2 + scale_x_discrete(breaks = c(1, 2, 3), labels = 'Reinforce concepts', 'Both about equally', 'Develop lab skills')
p2 + scale_x_discrete(breaks = c(1, 2, 3), labels = c('Reinforce concepts', 'Both about equally', 'Develop lab skills'))
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.interaction, type = 'eff', terms = c('URM_Status', 'Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted posttest scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$group <- factor(p2$data$group, levels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), order.terms = c(3, 1, 2), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), order.terms = c(1, 2, 3), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), sort.est = TRUE, dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), show.p = TRUE, dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = c('Lab_Purpose'), show.p = TRUE, dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(labels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', show.p = TRUE, dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(labels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', auto.label = FALSE, dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', auto.label = FALSE, order.terms = c(1, 2, 3), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
#p2$data$x <- c(1, 2, 3)
p2$facet$draw_labels
#p2$data$x <- c(1, 2, 3)
p2$layer
#p2$data$x <- c(1, 2, 3)
p2$labels$x
#p2$data$x <- c(1, 2, 3)
p2$labels$y
#p2$data$x <- c(1, 2, 3)
p2$coordinates$limits
#p2$data$x <- c(1, 2, 3)
p2$plot_env$...
#p2$data$x <- c(1, 2, 3)
p2$plot_env$x_lab
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$x <- c(1, 2, 3)
#p2$plot_env$x_lab
p2
p2$plot_env$x_lab <- c("Reinforce physics concepts", "Both about equally", "Develop lab skills")
p2
p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2
p2$plot_env$x
p2$data$x <- c(1, 2, 3)
p2$plot_env$x
p2$plot_env$x$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$plot_env$x$x <- c(1, 2, 3)
p2
p2$plot_env$x
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(labels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
p2 <- p1
p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(labels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills")) +
scale_x_discrete(labels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
p2 <- p1
p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(breaks = c(1, 2, 3))
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(breaks = c(1, 2, 3))
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2[[1]] + scale_x_discrete(labels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
#p2$data$x <- c(1, 2, 3)
p2[[1]] + scale_x_discrete(breaks = c(3, 1, 2))
p2[[1]]
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right') +
scale_x_discrete(breaks = c(1, 2, 3))
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2[[1]]$x <- c(1, 2, 3)
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2[[1]]$x <- c(1, 2, 3)
p2
p2[[1]]
p2$plot_env$x_lab
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
p2[[1]]$x <- c(1, 2, 3)
p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', order.terms = c(1, 2, 3), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', order.terms = c(3, 1, 2), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', auto.label = FALSE, order.terms = c(3, 1, 2), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', axis.labels = '', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', axis.labels = c('test', 'test1', 'test2'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5, axis.labels = c('test', 'test1', 'test2')) +
theme(legend.position = 'right')
p1
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = as.factor(Lab_Purpose, levels = c('Reinforce physics concepts', 'Both about equally', 'Develop lab skills'), ordered = TRUE))
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = factor(Lab_Purpose, levels = c('Reinforce physics concepts', 'Both about equally', 'Develop lab skills'), ordered = TRUE))
df.Centered <- Create.Class.Variables(df.matched)
df.Centered$GenW <- df.Centered$Gender == 'Women'
df.Centered$GenNon <- df.Centered$Gender == 'Non-binary'
df.Centered$URM_StatusURM <- df.Centered$URM_Status == 'URM'
df.Centered$MajorEng <- df.Centered$Major == 'Engineering'
df.Centered$MajorPhys <- df.Centered$Major == 'Physics'
df.Centered$PurposeSkills <- df.Centered$Lab_Purpose == 'Develop lab skills'
df.Centered$PurposeBoth <- df.Centered$Lab_Purpose == 'Both about equally'
df.Centered$LevelCalc <- df.Centered$Lab_Level == 'Intro-Calculus'
mod.null <- lmer(Gain ~ (1 | School/Class_ID), df.Centered)
summary(mod.null)
r.squaredGLMM(mod.null)
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | School/Class_ID), df.Centered)
summary(mod.main)
r.squaredGLMM(mod.main)
mod.interaction <- lmer(Gain ~ PreScores + (Gender + URM_Status) * Lab_Purpose + Major + Lab_Level + (1 | Class_ID), df.Centered)
summary(mod.interaction)
r.squaredGLMM(mod.interaction)
library(reghelper)
beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
class(mod.null) <- "lmerMod"
class(mod.main) <- "lmerMod"
class(mod.interaction) <- "lmerMod"
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = as.factor(Lab_Purpose), ref = 'Reinforce physics concepts'))
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = as.factor(Lab_Purpose), ref = 'Reinforce physics concepts')
df.Centered <- Create.Class.Variables(df.matched)
df.Centered$GenW <- df.Centered$Gender == 'Women'
df.Centered$GenNon <- df.Centered$Gender == 'Non-binary'
df.Centered$URM_StatusURM <- df.Centered$URM_Status == 'URM'
df.Centered$MajorEng <- df.Centered$Major == 'Engineering'
df.Centered$MajorPhys <- df.Centered$Major == 'Physics'
df.Centered$PurposeSkills <- df.Centered$Lab_Purpose == 'Develop lab skills'
df.Centered$PurposeBoth <- df.Centered$Lab_Purpose == 'Both about equally'
df.Centered$LevelCalc <- df.Centered$Lab_Level == 'Intro-Calculus'
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = as.factor(Lab_Purpose, ref = 'Reinforce physics concepts'))
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = relevel(as.factor(Lab_Purpose), ref = 'Reinforce physics concepts'))
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = relevel(as.factor(Lab_Purpose), ref = 'Reinforce physics concepts'))
df <- fread('C:/Users/Cole/Documents/PLIC_DATA/Collective_Surveys/Complete/Complete_Concat.csv') %>%
Clean.PLIC(., Matched = TRUE) %>%
Merge.CIS(., Matched = TRUE) %>%
filter(Survey_x == 'C' | Survey_y == 'C') %>%
filter((Lab_Level == 'Intro-Algebra') | (Lab_Level == 'Intro-Calculus'))
df %>%
summarize(N.Students = nrow(.), N.Classes = length(unique(.[, 'Class_ID'])), N.Schools = length(unique(.[, 'School'])))
# Filter by student demographics
df <- df %>%
filter(!is.na(Gender) & !is.na(Ethnicity) & !is.na(Major))
df %>%
summarize(N.Students = nrow(.), N.Classes = length(unique(.[, 'Class_ID'])), N.Schools = length(unique(.[, 'School'])))
df <- data.table(df)[, `:=`(N.students = .N, pre.rate = sum(Survey_x == 'C')/.N,
post.rate = sum(Survey_y == 'C')/.N),
.(Class_ID)]
data.frame(df[pre.rate == 0]) %>%
summarize(N.Classes = length(unique(.[, 'Class_ID'])))
# df[post.rate == 0 & !duplicated(Class_ID)]$Class_ID
data.frame(df[post.rate == 0]) %>%
summarize(N.Classes = length(unique(.[, 'Class_ID'])))
df.complete <- df[pre.rate >= 0.4 & post.rate >= 0.4]
data.frame(df.complete) %>%
summarize(N.Students = nrow(.), N.Classes = length(unique(.[, 'Class_ID'])), N.Schools = length(unique(.[, 'School'])))
df.matched <- df.complete[Survey_x == 'C' & Survey_y == 'C']
data.frame(df.matched) %>%
summarize(N.Students = nrow(.), N.Classes = length(unique(.[, 'Class_ID'])), N.Schools = length(unique(.[, 'School'])))
table(df.matched[!duplicated(df.matched$School),]$Institution_Type, exclude = NULL)
table(df.matched[!duplicated(df.matched$Class_ID),]$Lab_Level, exclude = NULL)
table(df.matched[!duplicated(df.matched$Class_ID),]$Lab_Purpose, exclude = NULL)
df.matched <- df.matched %>%
mutate(Gender = relevel(as.factor(Gender), ref = 'Men'),
URM_Status = relevel(as.factor(URM_Status), ref = 'Majority'),
Major = relevel(as.factor(Major), ref = 'Other'),
Lab_Level = relevel(as.factor(Lab_Level), ref = 'Intro-Algebra'),
Lab_Purpose = relevel(as.factor(Lab_Purpose), ref = 'Reinforce physics concepts'))
df.Centered <- Create.Class.Variables(df.matched)
df.Centered$GenW <- df.Centered$Gender == 'Women'
df.Centered$GenNon <- df.Centered$Gender == 'Non-binary'
df.Centered$URM_StatusURM <- df.Centered$URM_Status == 'URM'
df.Centered$MajorEng <- df.Centered$Major == 'Engineering'
df.Centered$MajorPhys <- df.Centered$Major == 'Physics'
df.Centered$PurposeSkills <- df.Centered$Lab_Purpose == 'Develop lab skills'
df.Centered$PurposeBoth <- df.Centered$Lab_Purpose == 'Both about equally'
df.Centered$LevelCalc <- df.Centered$Lab_Level == 'Intro-Calculus'
mod.null <- lmer(Gain ~ (1 | School/Class_ID), df.Centered)
summary(mod.null)
r.squaredGLMM(mod.null)
mod.main <- lmer(Gain ~ PreScores + Gender + URM_Status + Major + Lab_Purpose + Lab_Level + (1 | School/Class_ID), df.Centered)
summary(mod.main)
r.squaredGLMM(mod.main)
mod.interaction <- lmer(Gain ~ PreScores + (Gender + URM_Status) * Lab_Purpose + Major + Lab_Level + (1 | Class_ID), df.Centered)
summary(mod.interaction)
r.squaredGLMM(mod.interaction)
library(reghelper)
#beta(mod.main, skip = c('Gender', 'URM_Status', 'Major', 'Lab_Purpose', 'Lab_Level'))
class(mod.null) <- "lmerMod"
class(mod.main) <- "lmerMod"
class(mod.interaction) <- "lmerMod"
stargazer(mod.null, mod.main, mod.interaction, star.cutoffs = c(0.05, 0.01, 0.001), intercept.bottom = FALSE, out = 'Results.tex', intercept.top = TRUE, omit.stat = 'all')
plot(mod.interaction, xlab = 'Fitted values', ylab = 'Residuals')
qqmath(mod.interaction)
set_theme(base = theme_classic(base_size = 12))
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p1
set_theme(base = theme_classic(base_size = 12))
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2$data$x <- c(1, 2, 3)
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2
# p1 <- plot_model(mod.interaction, type = 'eff', terms = c('Gender [Men, Women]', 'Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted posttest scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
#   theme(legend.position = 'right')
#p1 <- plot_model(mod.interaction, type = 'eff', terms = c('URM_Status', 'Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted posttest scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
#  theme(legend.position = 'right')
#p2 <- p1
#p2$data$group <- factor(p2$data$group, levels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
#p2
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$mapping$x
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$labels$subtitle
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$facet$draw_labels
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$p$labels$x
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$y.breaks
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$y.limits
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$dot.size
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$alpha
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$ci
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$facets
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_is_factor
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_lab
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_lab[1]
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_lab[2]
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_lab[1] <- 'test'
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_lab[1] <- 'test'
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
#p2$data$x <- c(1, 2, 3)
#p2[[1]]$x <- c(1, 2, 3)
#p2$plot_env$x_lab <- c("Both about equally", "Develop lab skills", "Reinforce physics concepts")
p2$plot_env$x_lab <- factor(p2$plot_env$x_lab, levels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
#p2
p2
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2
set_theme(base = theme_classic(base_size = 12))
p1 <- plot_model(mod.main, type = 'eff', terms = 'Lab_Purpose', dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted gain in PLIC scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
theme(legend.position = 'right')
p2 <- p1
p2
# p1 <- plot_model(mod.interaction, type = 'eff', terms = c('Gender [Men, Women]', 'Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted posttest scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
#   theme(legend.position = 'right')
#p1 <- plot_model(mod.interaction, type = 'eff', terms = c('URM_Status', 'Lab_Purpose'), dot.size = 4, line.size = 1, ci.lvl = 0.67, title = '', axis.title = 'Predicted posttest scores', colors = c('#e69f00', '#009e74', '#0071b2'), dodge = 0.5) +
#  theme(legend.position = 'right')
#p2 <- p1
#p2$data$group <- factor(p2$data$group, levels = c("Reinforce physics concepts", "Both about equally", "Develop lab skills"))
#p2
